const R = require('ramda');

function chiSquared(observedValues) {
  const row1Total = R.sum(observedValues[0]);
  const row2Total = R.sum(observedValues[1]);
  const col1Total = R.sum(R.pluck(0, observedValues));
  const col2Total = R.sum(R.pluck(1, observedValues));
  const col3Total = R.sum(R.pluck(2, observedValues));
  const col4Total = R.sum(R.pluck(3, observedValues));
  const total = row1Total + row2Total;

  const expectedValues = [
    [(row1Total * col1Total) / total, (row1Total * col2Total) / total, (row1Total * col3Total) / total, (row1Total * col4Total) / total],
    [(row2Total * col1Total) / total, (row2Total * col2Total) / total, (row2Total * col3Total) / total, (row2Total * col4Total) / total],
  ];

  const chiSquared = R.pipe(
    R.zipWith(R.zip),
    R.map(([observedRow, expectedRow]) => R.sum(R.zipWith((observed, expected) => ((observed - expected) ** 2) / expected, observedRow, expectedRow)))),
    R.sum
  )(observedValues, expectedValues);

  return chiSquared;
}

// Exemple d'utilisation :
const observedValues = [
  [15, 12, 24, 12],
  [22, 28, 19, 6],
];
const chiSquaredValue = chiSquared(observedValues);
console.log(`Valeur du test de khi-deux : ${chiSquaredValue}`);
